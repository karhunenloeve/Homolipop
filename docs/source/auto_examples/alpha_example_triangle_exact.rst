
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/alpha_example_triangle_exact.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_alpha_example_triangle_exact.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_alpha_example_triangle_exact.py:


Example script: squared alpha values on a single triangle.

This file is a minimal, mathematically explicit sanity check for
:func:`homolipop.alpha.alpha_values_squared`.

Mathematical conventions
========================

Point cloud
-----------

Let

.. math::

   X = \{x_0, x_1, x_2\} \subset \mathbb R^2

be the point cloud given by the rows of the NumPy array ``points``.
Here

.. math::

   x_0 = (0,0),\quad x_1 = (1,0),\quad x_2 = (0,1).

Simplices
---------

We represent a simplex by a strictly increasing tuple of vertex indices.
Thus the single 2-simplex is

.. math::

   \sigma = (0,1,2),

its edges are :math:`(0,1)`, :math:`(0,2)`, :math:`(1,2)`,
and its vertices are :math:`(0)`, :math:`(1)`, :math:`(2)`.

Squared alpha value
-------------------

For any simplex :math:`\tau` with vertices :math:`V(\tau) \subset X`,
the squared alpha value is defined as

.. math::

   \alpha^2(\tau)
   =
   \min_{c \in \mathbb R^2} \max_{x \in V(\tau)} \|x-c\|^2
   \in [0,\infty).

Because :math:`V(\tau)` is finite, the minimum exists.

In this example, the triangle :math:`\sigma=(0,1,2)` is right-angled at :math:`x_0`.
Hence its smallest enclosing ball is the circle with diameter the hypotenuse
:math:`\overline{x_1x_2}`. The center is the midpoint

.. math::

   c = \tfrac12(x_1 + x_2) = \left(\tfrac12,\tfrac12\right),

and the squared radius is

.. math::

   \alpha^2(\sigma)
   = \|x_1 - c\|^2
   = \left(\tfrac12\right)^2 + \left(\tfrac12\right)^2
   = \tfrac12.

Therefore the expected output is ``alpha.alpha_sq[(0, 1, 2)] == 0.5``
up to floating point arithmetic.

For edges :math:`(i,j)` one has

.. math::

   \alpha^2(i,j) = \tfrac14\,\|x_i - x_j\|^2,

since the smallest enclosing ball of two points has diameter the segment between them.

For a vertex :math:`(i)` one has :math:`\alpha^2(i)=0`.

Numerical contract
------------------

All values are computed as IEEE 64 bit floats. Exact equality is expected here
because the geometry uses dyadic rationals, but this is not guaranteed in general.

.. GENERATED FROM PYTHON SOURCE LINES 90-143




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    triangle alpha^2: 0.5
    expected: 0.5
    edges:
    (0, 1) 0.25
    (0, 2) 0.25
    (1, 2) 0.5
    vertices:
    (0,) 0.0
    (1,) 0.0
    (2,) 0.0






|

.. code-block:: Python


    from __future__ import annotations

    import numpy as np

    from homolipop.alpha import alpha_values_squared


    def main() -> None:
        """
        Compute and print squared alpha values for a single Delaunay triangle.

        The script computes :math:`\\alpha^2` for all simplices of dimension at most 2
        generated by the triangle ``(0, 1, 2)`` and prints

        - the triangle value, compared against the known exact value :math:`1/2`
        - the edge values
        - the vertex values

        Notes
        -----
        This is a correctness sanity check for the basic geometric cases

        - a vertex has :math:`\\alpha^2 = 0`
        - an edge has :math:`\\alpha^2 = \\|x_i-x_j\\|^2 / 4`
        - a right triangle has :math:`\\alpha^2` equal to one quarter of the squared hypotenuse length
        """
        points = np.array(
            [
                [0.0, 0.0],
                [1.0, 0.0],
                [0.0, 1.0],
            ],
            dtype=float,
        )

        delaunay_triangles = [(0, 1, 2)]
        alpha = alpha_values_squared(points, delaunay_triangles, max_dim=2)

        expected_radius_sq = 0.5
        print("triangle alpha^2:", alpha.alpha_sq[(0, 1, 2)])
        print("expected:", expected_radius_sq)

        print("edges:")
        for e in [(0, 1), (0, 2), (1, 2)]:
            print(e, alpha.alpha_sq[e])

        print("vertices:")
        for v in [(0,), (1,), (2,)]:
            print(v, alpha.alpha_sq[v])


    if __name__ == "__main__":
        main()

.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.002 seconds)


.. _sphx_glr_download_auto_examples_alpha_example_triangle_exact.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: alpha_example_triangle_exact.ipynb <alpha_example_triangle_exact.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: alpha_example_triangle_exact.py <alpha_example_triangle_exact.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: alpha_example_triangle_exact.zip <alpha_example_triangle_exact.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
